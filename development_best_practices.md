# 🛡️ 交易機器人開發最佳實踐指南

為了確保交易機器人在持續開發新功能的同時保持穩定，建議遵循以下工程標準。

## 1. 版本控制 (Git)
務必使用 Git 來追蹤所有代碼變更。這能讓你隨時「撤銷」錯誤。
- **主分支 (Main Branch)**：只存放「經測試驗證」的穩定代碼。
- **開發分支 (Feature Branches)**：每次新增功能或修改（例如：`git checkout -b fix-binance-integration`）都要建立新分支。
- **提交次數 (Commits)**：保持高頻率的小型提交，並撰寫清楚的註解。

## 2. 模擬模式 (第一道防線)
在將任何變更部署到實盤交易前：
- 在 `config.yaml` 中設置 `is_simulation: true`。
- 讓機器人運行至少 30-60 分鐘，觀察日誌輸出。
- 確認「模擬訂單」的下單大小 (Size) 與價格 (Price) 是否完全符合預期。

## 3. 自動化測試
建立一個 `tests/` 目錄，在不啟動完整機器人的情況下驗證邏輯。
- **單元測試 (Unit Tests)**：測試獨立函數（例如：資金費率換算、小數位縮放）。
- **整合測試 (Integration Tests)**：透過小型「探針」腳本測試交易所連線（就像我們除錯時使用的 Lighter 測試腳本）。

## 4. 測試環境 (Staging)
如果可能，請使用具備少量資金的專屬 API Key。如果交易所支持 Testnet (測試網)，應優先在測試網上線。

## 5. 影子交易 (Shadow Trading)
在實盤數據上運行邏輯但不實際發送鏈上交易，僅記錄「如果是實盤，機器人會執行什麼動作」，以此驗證策略在真實行情下的反應。

## 6. 重啟前檢查清單 (Pre-Flight Checklist)
每次實盤重啟前的四個步驟：
1. `git diff`：逐行檢查所有被修改的代碼。
2. `python -m py_compile run_strategy.py`：確認沒有語法錯誤。
3. 檢查 `.env`：確認 API Key 切換正確。
4. 清理進程：執行 `killall python3` 確保沒有殘留的舊執行實例。

## 7. 持續監控與警報
利用 TUI Dashboard 密切觀察新版本上線後的前 15 分鐘。重點注意：
- 是否出現 Nonce 衝突。
- 是否出現異常大的訂單。
- 是否頻繁出現連線超時 (Timeout)。
